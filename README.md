# è§†é¢‘å¤„ç† API æœåŠ¡ v2.2

[![Version](https://img.shields.io/badge/version-2.2.0-blue.svg)](./VERSION)
[![Docker](https://img.shields.io/badge/docker-ready-green.svg)](./docker-compose.yml)
[![API](https://img.shields.io/badge/API-async-orange.svg)](./API_DOCUMENTATION.md)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](./LICENSE)

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŠŸèƒ½å…¨é¢çš„é«˜æ€§èƒ½è§†é¢‘å¤„ç† API æœåŠ¡ï¼Œæä¾›è§†é¢‘è½¬å½•ã€ä¸‹è½½ã€å…³é”®å¸§æå–ã€è§†é¢‘åˆæˆç­‰å¤šç§åŠŸèƒ½ã€‚æ”¯æŒæ•°ç™¾ä¸ªè§†é¢‘å¹³å°ï¼ˆåŸºäº yt-dlpï¼‰ï¼Œé‡‡ç”¨å¼‚æ­¥å¤„ç†æ¶æ„ï¼Œå®Œç¾è§£å†³é•¿è§†é¢‘å¤„ç†æ—¶çš„è¿æ¥è¶…æ—¶é—®é¢˜ã€‚

v2.2 ç‰ˆæœ¬åœ¨å¼‚æ­¥å¤„ç†åŸºç¡€ä¸Šæ–°å¢äº†è§†é¢‘ä¸‹è½½ã€å…³é”®å¸§æå–ã€è§†é¢‘åˆæˆç­‰åŠŸèƒ½ï¼Œå¹¶ä¼˜åŒ–äº†å†…å­˜ä½¿ç”¨å’Œç¡¬ä»¶åŠ é€Ÿæ”¯æŒã€‚

## âœ¨ v2.2 æ–°ç‰¹æ€§

- **ğŸš€ å¼‚æ­¥å¤„ç†**ï¼šé‡‡ç”¨åå°ä»»åŠ¡å¤„ç†ï¼Œæ”¯æŒé•¿è§†é¢‘å¤„ç†ï¼Œæ— è¿æ¥è¶…æ—¶é—®é¢˜
- **ğŸ“Š å®æ—¶è¿›åº¦**ï¼šæä¾›0-100%çš„è¯¦ç»†è¿›åº¦ç›‘æ§å’ŒçŠ¶æ€æŸ¥è¯¢
- **ğŸ¬ è§†é¢‘ä¸‹è½½**ï¼šæ”¯æŒå¤šç§è´¨é‡å’Œæ ¼å¼çš„è§†é¢‘ä¸‹è½½åŠŸèƒ½
- **ğŸ–¼ï¸ å…³é”®å¸§æå–**ï¼šæ™ºèƒ½æå–è§†é¢‘å…³é”®å¸§ï¼Œç”Ÿæˆé¢„è§ˆå›¾å’Œç¼©ç•¥å›¾ç½‘æ ¼
- **ğŸï¸ è§†é¢‘åˆæˆ**ï¼šæ”¯æŒå¤šç§åˆæˆæ¨¡å¼ï¼ˆæ‹¼æ¥ã€ç”»ä¸­ç”»ã€å¹¶æ’æ˜¾ç¤ºç­‰ï¼‰
- **âš¡ æ€§èƒ½ä¼˜åŒ–**ï¼šç¡¬ä»¶åŠ é€Ÿã€å†…å­˜ä¼˜åŒ–ã€ç¼“å­˜ç®¡ç†
- **ğŸ”„ åˆ†ç¦»å¼API**ï¼šçŠ¶æ€æŸ¥è¯¢å’Œç»“æœè·å–åˆ†ç¦»ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- **ğŸ›¡ï¸ ç¨³å®šæ€§å¢å¼º**ï¼šæ™ºèƒ½èµ„æºç›‘æ§ã€è‡ªåŠ¨åƒåœ¾å›æ”¶ã€Dockerèµ„æºé™åˆ¶
- **ğŸ“š å®Œæ•´æ–‡æ¡£**ï¼šè¯¦ç»†çš„APIæ–‡æ¡£å’Œé›†æˆæŒ‡å—

## ğŸ—ï¸ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¯ è§†é¢‘å¤„ç†åŠŸèƒ½
- **å¼‚æ­¥è½¬å½•**ï¼šæ”¯æŒé•¿è¾¾2å°æ—¶çš„è§†é¢‘è½¬å½•ï¼Œæ— é˜»å¡å¤„ç†
- **è§†é¢‘ä¸‹è½½**ï¼šæ”¯æŒå¤šç§è´¨é‡ï¼ˆ720pã€1080pã€4Kï¼‰å’Œæ ¼å¼ï¼ˆMP4ã€WebMã€MKVï¼‰
- **å…³é”®å¸§æå–**ï¼šæ™ºèƒ½æå–è§†é¢‘å…³é”®å¸§ï¼Œæ”¯æŒå¤šç§æå–æ–¹æ³•å’Œè‡ªå®šä¹‰å‚æ•°
- **è§†é¢‘åˆæˆ**ï¼šæ”¯æŒå¤šç§åˆæˆæ¨¡å¼ï¼ŒåŒ…æ‹¬æ‹¼æ¥ã€ç”»ä¸­ç”»ã€å¹¶æ’æ˜¾ç¤ºç­‰
- **æœ¬åœ°æ–‡ä»¶å¤„ç†**ï¼šç›´æ¥å¤„ç†æœ¬åœ°è§†é¢‘æ–‡ä»¶ï¼Œæ— éœ€ä¸Šä¼ 

### ğŸŒ å¹³å°æ”¯æŒ
- **å¤šå¹³å°æ”¯æŒ**ï¼šåŸºäº `yt-dlp`ï¼Œæ”¯æŒæ•°ç™¾ä¸ªè§†é¢‘ç½‘ç«™
- **ä¸»æµå¹³å°**ï¼šYouTubeã€Bilibiliã€Vimeoã€Dailymotionã€TikTokç­‰
- **é«˜ç²¾åº¦è¯†åˆ«**ï¼šä½¿ç”¨ `faster-whisper` æ¨¡å‹ï¼Œå‡†ç¡®ç‡é«˜
- **ä¸°å¯Œå…ƒæ•°æ®**ï¼šè¿”å›æ ‡é¢˜ã€ä½œè€…ã€å°é¢ã€ç»Ÿè®¡æ•°æ®ç­‰å®Œæ•´ä¿¡æ¯

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§
- **æ ‡å‡†åŒ–API**ï¼šRESTfulè®¾è®¡ï¼Œæ˜“äºé›†æˆåˆ°å„ç§ç³»ç»Ÿä¸­
- **ç¡¬ä»¶åŠ é€Ÿ**ï¼šæ”¯æŒGPUåŠ é€Ÿå’Œç¡¬ä»¶ç¼–ç å™¨ï¼ˆNVENCã€VideoToolboxç­‰ï¼‰
- **æ™ºèƒ½ç¼“å­˜**ï¼šè‡ªåŠ¨ç¼“å­˜ç®¡ç†ï¼Œæå‡å¤„ç†æ•ˆç‡
- **èµ„æºç›‘æ§**ï¼šå®æ—¶ç›‘æ§CPUã€å†…å­˜ä½¿ç”¨æƒ…å†µ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ä½ éœ€è¦å…ˆåœ¨ä½ çš„ç”µè„‘ä¸Šå®‰è£… Python (å»ºè®® 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬)ã€‚

### 2. å…‹éš†é¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/ncandyaoe/download-video-subtitle.git
cd download-video-subtitle
```

### 3. å®‰è£…ä¾èµ–

```bash
# å®‰è£…æ‰€æœ‰éœ€è¦çš„ Python åº“
pip install -r requirements.txt
```

#### ç³»ç»Ÿä¾èµ–

æœ¬é¡¹ç›®éœ€è¦ `ffmpeg` æ¥å¤„ç†éŸ³é¢‘å’Œè§†é¢‘ï¼š

- **macOS**: `brew install ffmpeg`
- **Ubuntu/Debian**: `sudo apt update && sudo apt install ffmpeg`
- **Windows**: ä¸‹è½½ `ffmpeg` åï¼Œå°†å…¶ `bin` ç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ `Path` ä¸­
- **CentOS/RHEL**: `sudo yum install ffmpeg` æˆ– `sudo dnf install ffmpeg`

### 4. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨ API æœåŠ¡
python run.py
```

æœåŠ¡å¯åŠ¨åï¼Œä½ ä¼šåœ¨ç»ˆç«¯çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„ä¿¡æ¯ï¼š

```
INFO:     Uvicorn running on http://0.0.0.0:7878 (Press CTRL+C to quit)
INFO:     å¯åŠ¨è§†é¢‘å¤„ç†APIæœåŠ¡
```

### 5. éªŒè¯æœåŠ¡

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:7878/health

# æŸ¥çœ‹APIæ–‡æ¡£
open http://localhost:7878/docs
```

## ğŸ³ Docker éƒ¨ç½²ï¼ˆæ¨èï¼‰

### å¿«é€Ÿå¯åŠ¨

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/ncandyaoe/download-video-subtitle.git
cd download-video-subtitle

# ä½¿ç”¨ Docker Compose å¯åŠ¨
docker-compose up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

### å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
curl http://localhost:7878/health

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker logs subtitle-service -f
```

## ğŸ“š API ä½¿ç”¨è¯´æ˜

æœ¬æœåŠ¡æä¾›å®Œæ•´çš„è§†é¢‘å¤„ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬è½¬å½•ã€ä¸‹è½½ã€å…³é”®å¸§æå–å’Œè§†é¢‘åˆæˆã€‚æ‰€æœ‰åŠŸèƒ½éƒ½é‡‡ç”¨å¼‚æ­¥å¤„ç†æ¶æ„ã€‚

> ğŸ“– **å®Œæ•´APIæ–‡æ¡£**: æŸ¥çœ‹ [API_DOCUMENTATION.md](./API_DOCUMENTATION.md) è·å–è¯¦ç»†çš„æ¥å£è¯´æ˜

### è½¬å½•åŠŸèƒ½ä½¿ç”¨

è½¬å½•API ä½¿ç”¨åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š

### 1. å¯åŠ¨è½¬å½•ä»»åŠ¡

**Endpoint**: `POST /generate_text_from_video`

```bash
curl -X POST "http://localhost:7878/generate_text_from_video" \
-H "Content-Type: application/json" \
-d '{"video_url": "https://www.youtube.com/watch?v=VIDEO_ID"}'
```

**å“åº”**:
```json
{
  "task_id": "uuid-string",
  "status": "started",
  "message": "è½¬å½•ä»»åŠ¡å·²å¯åŠ¨ï¼Œè¯·ä½¿ç”¨task_idæŸ¥è¯¢è¿›åº¦"
}
```

### 2. æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

**Endpoint**: `GET /task_status/{task_id}`

```bash
curl -X GET "http://localhost:7878/task_status/your-task-id"
```

**å“åº”**:
```json
{
  "task_id": "uuid-string",
  "status": "processing",
  "progress": 50,
  "message": "å¼€å§‹è½¬å½•...",
  "result_available": false
}
```

### 3. è·å–å®Œæ•´ç»“æœ

**Endpoint**: `GET /task_result/{task_id}`

```bash
curl -X GET "http://localhost:7878/task_result/your-task-id"
```

**å“åº”**:
```json
{
  "task_id": "uuid-string",
  "result": {
    "title": "è§†é¢‘æ ‡é¢˜",
    "id": "è§†é¢‘ID",
    "duration": 123.45,
    "author": "ä½œè€…",
    "text": "å®Œæ•´è½¬å½•æ–‡æœ¬...",
    "srt": "SRTæ ¼å¼å­—å¹•...",
    "language": "en",
    "like_count": 1000,
    "view_count": 50000
  }
}
```

### è§†é¢‘ä¸‹è½½åŠŸèƒ½

**å¯åŠ¨ä¸‹è½½ä»»åŠ¡**:
```bash
curl -X POST "http://localhost:7878/download_video" \
-H "Content-Type: application/json" \
-d '{
  "video_url": "https://www.youtube.com/watch?v=VIDEO_ID",
  "quality": "720p",
  "format": "mp4"
}'
```

**æŸ¥è¯¢çŠ¶æ€å’Œè·å–ç»“æœ**:
```bash
# æŸ¥è¯¢ä¸‹è½½çŠ¶æ€
curl -X GET "http://localhost:7878/download_status/{task_id}"

# è·å–ä¸‹è½½ç»“æœ
curl -X GET "http://localhost:7878/download_result/{task_id}"

# ä¸‹è½½æ–‡ä»¶
curl -X GET "http://localhost:7878/download_file/{task_id}" -o "video.mp4"
```

### å…³é”®å¸§æå–åŠŸèƒ½

æ”¯æŒå¤šç§æå–æ–¹æ³•ï¼ˆé—´éš”ã€æ•°é‡ã€åœºæ™¯å˜åŒ–ç­‰ï¼‰ï¼š

**å¯åŠ¨æå–ä»»åŠ¡**:
```bash
curl -X POST "http://localhost:7878/extract_keyframes" \
-H "Content-Type: application/json" \
-d '{
  "video_url": "https://www.youtube.com/watch?v=VIDEO_ID",
  "method": "interval",
  "interval": 30,
  "width": 1280,
  "height": 720
}'
```

**è·å–ç»“æœ**:
```bash
# æŸ¥è¯¢çŠ¶æ€
curl -X GET "http://localhost:7878/keyframe_status/{task_id}"

# è·å–ç»“æœ
curl -X GET "http://localhost:7878/keyframe_result/{task_id}"

# ä¸‹è½½å•ä¸ªå…³é”®å¸§
curl -X GET "http://localhost:7878/keyframe_image/{task_id}/0" -o "frame_0.jpg"

# ä¸‹è½½ç¼©ç•¥å›¾ç½‘æ ¼
curl -X GET "http://localhost:7878/keyframe_thumbnail/{task_id}" -o "thumbnail.jpg"
```

### è§†é¢‘åˆæˆåŠŸèƒ½

æ”¯æŒå¤šç§åˆæˆæ¨¡å¼ï¼š

**å¯åŠ¨åˆæˆä»»åŠ¡**:
```bash
curl -X POST "http://localhost:7878/compose_videos" \
-H "Content-Type: application/json" \
-d '{
  "video_urls": [
    "https://www.youtube.com/watch?v=VIDEO_ID1",
    "https://www.youtube.com/watch?v=VIDEO_ID2"
  ],
  "composition_type": "side_by_side",
  "output_quality": "720p"
}'
```

## ğŸ”§ è¿›åº¦çŠ¶æ€è¯´æ˜

| è¿›åº¦èŒƒå›´ | çŠ¶æ€æè¿° |
|---------|---------|
| 0-10% | è·å–è§†é¢‘å…ƒæ•°æ® |
| 10-30% | ä¸‹è½½éŸ³é¢‘æ–‡ä»¶ |
| 30-50% | å‡†å¤‡è½¬å½• |
| 50-80% | æ‰§è¡Œè¯­éŸ³è¯†åˆ« |
| 80-95% | å¤„ç†è½¬å½•ç»“æœ |
| 95-100% | ä¿å­˜æ–‡ä»¶å’Œå®Œæˆ |

## ï¿½  ç›¸å…³æ–‡æ¡£

- **[API æ¥å£æ–‡æ¡£](./API_DOCUMENTATION.md)** - å®Œæ•´çš„APIæ¥å£è¯´æ˜
- **[N8N é›†æˆæŒ‡å—](./N8N_USAGE_GUIDE.md)** - n8nå·¥ä½œæµé›†æˆ
- **[æµ‹è¯•æŒ‡å—](./TESTING_GUIDE.md)** - æµ‹è¯•ç”¨ä¾‹å’Œä½¿ç”¨æ–¹æ³•
- **[æ”¯æŒçš„ç½‘ç«™](./SUPPORTED_SITES.md)** - æ”¯æŒçš„è§†é¢‘å¹³å°åˆ—è¡¨
- **[èµ„æºç›‘æ§](./RESOURCE_MONITORING_IMPLEMENTATION.md)** - ç³»ç»Ÿç›‘æ§è¯´æ˜
- **[é”™è¯¯å¤„ç†](./ERROR_HANDLING_IMPLEMENTATION.md)** - é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ› ï¸ å¼€å‘å·¥å…·

é¡¹ç›®æä¾›äº†å¤šä¸ªå®ç”¨å·¥å…·å’Œè„šæœ¬ï¼š

### æœåŠ¡ç®¡ç†
```bash
# ç›‘æ§æœåŠ¡çŠ¶æ€
./monitor.sh

# é‡å¯æœåŠ¡
./restart-service.sh

# æ€§èƒ½æµ‹è¯•
./performance_test.sh
```

### åŠŸèƒ½æ¼”ç¤º
```bash
# è½¬å½•æ¼”ç¤º
./demo_progress.sh "https://www.youtube.com/watch?v=VIDEO_ID"

# è§†é¢‘ä¸‹è½½æ¼”ç¤º
./demo_download.sh "https://www.youtube.com/watch?v=VIDEO_ID" 720p mp4

# å…³é”®å¸§æå–æ¼”ç¤º
./demo_keyframes.sh "https://www.youtube.com/watch?v=VIDEO_ID" interval 30

# è§†é¢‘åˆæˆæ¼”ç¤º
./demo_composition.sh
```

### æµ‹è¯•å·¥å…·
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cd test_files && ./run_tests.sh

# æ€§èƒ½åŸºå‡†æµ‹è¯•
python performance_benchmark.py

# æ£€æŸ¥æ”¯æŒçš„ç½‘ç«™
python check_site_support.py
```

## ğŸ“ æ–‡ä»¶è¾“å‡ºç»“æ„

### è½¬å½•æ–‡ä»¶
```
./output/
â”œâ”€â”€ VIDEO_ID.mp3    # æå–çš„éŸ³é¢‘æ–‡ä»¶
â”œâ”€â”€ VIDEO_ID.srt    # SRTæ ¼å¼å­—å¹•æ–‡ä»¶
â””â”€â”€ VIDEO_ID.txt    # çº¯æ–‡æœ¬è½¬å½•æ–‡ä»¶
```

### è§†é¢‘ä¸‹è½½æ–‡ä»¶
```
./downloads/
â”œâ”€â”€ VIDEO_ID_720p.mp4     # 720p MP4è§†é¢‘
â”œâ”€â”€ VIDEO_ID_1080p.webm   # 1080p WebMè§†é¢‘
â””â”€â”€ VIDEO_ID_best.mkv     # æœ€ä½³è´¨é‡è§†é¢‘
```

### å…³é”®å¸§æ–‡ä»¶
```
./keyframes/
â”œâ”€â”€ {task_id}/
â”‚   â”œâ”€â”€ frame_000000.jpg    # å…³é”®å¸§å›¾ç‰‡
â”‚   â”œâ”€â”€ frame_000030.jpg
â”‚   â”œâ”€â”€ frame_000060.jpg
â”‚   â””â”€â”€ thumbnail_grid.jpg  # ç¼©ç•¥å›¾ç½‘æ ¼
â””â”€â”€ metadata.json           # æå–ä¿¡æ¯
```

### è§†é¢‘åˆæˆæ–‡ä»¶
```
./compositions/
â”œâ”€â”€ {task_id}/
â”‚   â”œâ”€â”€ composition.mp4     # åˆæˆåçš„è§†é¢‘
â”‚   â”œâ”€â”€ temp/              # ä¸´æ—¶æ–‡ä»¶
â”‚   â””â”€â”€ metadata.json      # åˆæˆä¿¡æ¯
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
```bash
PYTHONUNBUFFERED=1          # ç¦ç”¨Pythonè¾“å‡ºç¼“å†²
OMP_NUM_THREADS=4           # OpenMPçº¿ç¨‹æ•°
MKL_NUM_THREADS=4           # MKLçº¿ç¨‹æ•°
MALLOC_TRIM_THRESHOLD_=100000  # å†…å­˜ç®¡ç†ä¼˜åŒ–
```

### Docker èµ„æºé…ç½®
- **å†…å­˜é™åˆ¶**: 16GBï¼ˆæ”¯æŒé•¿è§†é¢‘å¤„ç†ï¼‰
- **CPUé™åˆ¶**: 8æ ¸å¿ƒ
- **ä¿ç•™èµ„æº**: 6GBå†…å­˜ï¼Œ3æ ¸å¿ƒCPU

### æ¨¡å‹é…ç½®
```python
# åœ¨ api.py ä¸­å¯é…ç½®
MODEL_SIZE = "tiny"  # å¯é€‰: tiny, base, small, medium, large
DEVICE = "auto"      # å¯é€‰: auto, cpu, cuda
```

### ç¡¬ä»¶åŠ é€Ÿé…ç½®
- **GPUåŠ é€Ÿ**: è‡ªåŠ¨æ£€æµ‹CUDA/OpenCL
- **ç¡¬ä»¶ç¼–ç **: æ”¯æŒNVENCã€VideoToolboxã€QSVç­‰
- **å†…å­˜ä¼˜åŒ–**: æ™ºèƒ½ç¼“å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶

## ğŸš¨ æ³¨æ„äº‹é¡¹

### æ€§èƒ½ç›¸å…³
1. **é¦–æ¬¡å¯åŠ¨**ï¼šæ¨¡å‹åŠ è½½å¯èƒ½éœ€è¦1-2åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…
2. **é¦–æ¬¡çŠ¶æ€æŸ¥è¯¢**ï¼šå¯èƒ½éœ€è¦5-15ç§’å“åº”æ—¶é—´ï¼ˆæ­£å¸¸ç°è±¡ï¼‰
3. **å†…å­˜ä½¿ç”¨**ï¼šé•¿è§†é¢‘å’Œé«˜è´¨é‡å¤„ç†ä¼šæ¶ˆè€—æ›´å¤šå†…å­˜
4. **ç¡¬ä»¶åŠ é€Ÿ**ï¼šé¦–æ¬¡ä½¿ç”¨GPUæ—¶éœ€è¦åˆå§‹åŒ–ï¼Œå¯èƒ½è¾ƒæ…¢

### é™åˆ¶è¯´æ˜
1. **è§†é¢‘æ—¶é•¿**ï¼šå»ºè®®å•ä¸ªè§†é¢‘ä¸è¶…è¿‡2å°æ—¶
2. **å¹¶å‘ä»»åŠ¡**ï¼šå»ºè®®åŒæ—¶å¤„ç†ä»»åŠ¡æ•°ä¸è¶…è¿‡3ä¸ª
3. **ç½‘ç»œè¦æ±‚**ï¼šéœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥ä¸‹è½½è§†é¢‘
4. **å­˜å‚¨ç©ºé—´**ï¼šç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´å­˜å‚¨è¾“å‡ºæ–‡ä»¶

### Docker ç›¸å…³
1. **å¥åº·æ£€æŸ¥**ï¼šä½¿ç”¨curlè¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œç¡®ä¿æœåŠ¡æ­£å¸¸è¿è¡Œ
2. **èµ„æºç›‘æ§**ï¼šDockeré…ç½®äº†èµ„æºé™åˆ¶ï¼Œé¿å…ç³»ç»Ÿè¿‡è½½
3. **è‡ªåŠ¨é‡å¯**ï¼šæœåŠ¡å¼‚å¸¸æ—¶ä¼šè‡ªåŠ¨é‡å¯

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### è½¬å½•æ€§èƒ½
- **çŸ­è§†é¢‘ï¼ˆ<5åˆ†é’Ÿï¼‰**ï¼šé€šå¸¸1-2åˆ†é’Ÿå®Œæˆ
- **ä¸­ç­‰è§†é¢‘ï¼ˆ5-30åˆ†é’Ÿï¼‰**ï¼šé€šå¸¸3-8åˆ†é’Ÿå®Œæˆ  
- **é•¿è§†é¢‘ï¼ˆ30åˆ†é’Ÿ-2å°æ—¶ï¼‰**ï¼šé€šå¸¸10-30åˆ†é’Ÿå®Œæˆ
- **çŠ¶æ€æŸ¥è¯¢å“åº”**ï¼š10-30msï¼ˆé™¤é¦–æ¬¡æŸ¥è¯¢å¤–ï¼‰

### ä¸‹è½½æ€§èƒ½
- **720pè§†é¢‘**ï¼šé€šå¸¸æ¯”å®æ—¶æ’­æ”¾å¿«2-5å€
- **1080pè§†é¢‘**ï¼šé€šå¸¸æ¯”å®æ—¶æ’­æ”¾å¿«1-3å€
- **4Kè§†é¢‘**ï¼šå–å†³äºç½‘ç»œå¸¦å®½å’ŒæºæœåŠ¡å™¨

### å…³é”®å¸§æå–
- **é—´éš”æå–**ï¼šæ¯ç§’å¤„ç†çº¦10-20å¸§
- **åœºæ™¯æ£€æµ‹**ï¼šæ¯ç§’å¤„ç†çº¦5-10å¸§
- **ç¼©ç•¥å›¾ç”Ÿæˆ**ï¼šé€šå¸¸1-3ç§’å®Œæˆ

### è§†é¢‘åˆæˆ
- **ç®€å•æ‹¼æ¥**ï¼šé€šå¸¸æ¯”è§†é¢‘æ€»æ—¶é•¿å¿«5-10å€
- **å¤æ‚åˆæˆ**ï¼šé€šå¸¸æ¯”è§†é¢‘æ€»æ—¶é•¿å¿«2-5å€

## ğŸš€ é¡¹ç›®ç‰¹è‰²

### ğŸ¯ è®¾è®¡ç†å¿µ
- **å¼‚æ­¥ä¼˜å…ˆ**ï¼šæ‰€æœ‰è€—æ—¶æ“ä½œéƒ½é‡‡ç”¨å¼‚æ­¥å¤„ç†ï¼Œé¿å…é˜»å¡
- **èµ„æºæ™ºèƒ½**ï¼šæ™ºèƒ½æ£€æµ‹å’Œä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿï¼Œä¼˜åŒ–æ€§èƒ½
- **ç”¨æˆ·å‹å¥½**ï¼šæä¾›è¯¦ç»†çš„è¿›åº¦åé¦ˆå’Œé”™è¯¯ä¿¡æ¯
- **æ‰©å±•æ€§å¼º**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ·»åŠ æ–°åŠŸèƒ½

### ğŸ”§ æŠ€æœ¯æ ˆ
- **åç«¯æ¡†æ¶**ï¼šFastAPI + Uvicorn
- **éŸ³é¢‘å¤„ç†**ï¼šfaster-whisper + yt-dlp
- **è§†é¢‘å¤„ç†**ï¼šFFmpeg + OpenCV
- **å¼‚æ­¥å¤„ç†**ï¼šasyncio + threading
- **å®¹å™¨åŒ–**ï¼šDocker + Docker Compose
- **ç›‘æ§**ï¼špsutil + loguru

### ğŸŒŸ æ ¸å¿ƒä¼˜åŠ¿
1. **é«˜æ€§èƒ½**ï¼šç¡¬ä»¶åŠ é€Ÿ + æ™ºèƒ½ç¼“å­˜
2. **é«˜å¯ç”¨**ï¼šè‡ªåŠ¨é‡å¯ + å¥åº·æ£€æŸ¥
3. **æ˜“é›†æˆ**ï¼šæ ‡å‡†REST API + è¯¦ç»†æ–‡æ¡£
4. **å¤šåŠŸèƒ½**ï¼šè½¬å½• + ä¸‹è½½ + æå– + åˆæˆ

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/ncandyaoe/download-video-subtitle.git
cd download-video-subtitle

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements_test.txt

# è¿è¡Œæµ‹è¯•
cd test_files && ./run_tests.sh
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](./LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [yt-dlp](https://github.com/yt-dlp/yt-dlp) - è§†é¢‘ä¸‹è½½
- [faster-whisper](https://github.com/guillaumekln/faster-whisper) - è¯­éŸ³è¯†åˆ«
- [FastAPI](https://github.com/tiangolo/fastapi) - Webæ¡†æ¶
- [FFmpeg](https://ffmpeg.org/) - éŸ³è§†é¢‘å¤„ç†

## ğŸ” æœåŠ¡çŠ¶æ€æ£€æŸ¥

### å¿«é€Ÿæ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ

```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps | grep subtitle-service

# æ£€æŸ¥å¥åº·çŠ¶æ€
curl -X GET "http://localhost:7878/health"

# æ£€æŸ¥æœåŠ¡æ ¹è·¯å¾„
curl -X GET "http://localhost:7878/"

# è¿è¡Œå®Œæ•´ç›‘æ§
./monitor.sh
```

### å¸¸è§é—®é¢˜æ’æŸ¥

1. **æœåŠ¡æ— æ³•å¯åŠ¨**ï¼šæ£€æŸ¥Dockeræ˜¯å¦è¿è¡Œï¼Œç«¯å£7878æ˜¯å¦è¢«å ç”¨
2. **å¥åº·æ£€æŸ¥å¤±è´¥**ï¼šç­‰å¾…æ¨¡å‹åŠ è½½å®Œæˆï¼ˆé¦–æ¬¡å¯åŠ¨éœ€è¦1-2åˆ†é’Ÿï¼‰
3. **è½¬å½•å¤±è´¥**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥å’Œè§†é¢‘URLæ˜¯å¦æœ‰æ•ˆ
4. **å†…å­˜ä¸è¶³**ï¼šæ£€æŸ¥Dockerå†…å­˜é™åˆ¶ï¼Œå»ºè®®è‡³å°‘16GB
5. **ä¸‹è½½å¤±è´¥**ï¼šæ£€æŸ¥è§†é¢‘æ˜¯å¦å¯è®¿é—®ï¼ŒæŸäº›åœ°åŒºå¯èƒ½éœ€è¦ä»£ç†
6. **GPUä¸å¯ç”¨**ï¼šæ£€æŸ¥CUDAé©±åŠ¨å’ŒDocker GPUæ”¯æŒ

### æœåŠ¡é‡å¯

```bash
# é‡å¯æœåŠ¡
./restart-service.sh

# æˆ–è€…æ‰‹åŠ¨é‡å¯
docker-compose down
docker-compose up -d --build
```
